(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{383:function(s,n,t){"use strict";t.r(n);var a=t(4),e=Object(a.a)({},(function(){var s=this,n=s._self._c;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h2",{attrs:{id:"一、了解k8s相关"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#一、了解k8s相关"}},[s._v("#")]),s._v(" 一、了解k8s相关")]),s._v(" "),n("p",[s._v("参考：")]),s._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://www.cnblogs.com/xkops/p/6165565.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("k8s入门介绍"),n("OutboundLink")],1)]),s._v(" "),n("li",[n("a",{attrs:{href:"https://www.jianshu.com/p/b0e347a57057",target:"_blank",rel:"noopener noreferrer"}},[s._v("k8s中pod的理解以及k8s运行流程"),n("OutboundLink")],1)])]),s._v(" "),n("h2",{attrs:{id:"二、手动搭建k8s集群"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#二、手动搭建k8s集群"}},[s._v("#")]),s._v(" 二、手动搭建k8s集群")]),s._v(" "),n("h3",{attrs:{id:"_2-1搭建minikube单机版k8s集群"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-1搭建minikube单机版k8s集群"}},[s._v("#")]),s._v(" 2.1搭建minikube单机版k8s集群")]),s._v(" "),n("p",[s._v("minikube基于go语言开发，可以在单机环境下快速搭建可用的k8s集群，非常适合测试和本地开发。简而言之，"),n("strong",[s._v("minikube是只有一个节点的k8s集群实现。")]),s._v("\n参考：")]),s._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://www.runoob.com/w3cnote/vmware-install-centos7.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("VMware 安装 Centos7 超详细过程"),n("OutboundLink")],1)]),s._v(" "),n("li",[n("a",{attrs:{href:"https://blog.csdn.net/u014636124/article/details/105145674/",target:"_blank",rel:"noopener noreferrer"}},[s._v("win10上Minikube快速搭建k8s"),n("OutboundLink")],1)]),s._v(" "),n("li",[n("a",{attrs:{href:"https://qii404.me/2018/01/06/minukube.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("使用minikube在centOS搭建kubernetes集群"),n("OutboundLink")],1)]),s._v(" "),n("li",[n("a",{attrs:{href:"https://www.cnblogs.com/mengyucloud/p/12244168.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("本地安装单机版的minikube"),n("OutboundLink")],1)]),s._v(" "),n("li",[n("a",{attrs:{href:"https://www.cnblogs.com/mengyucloud/p/12245335.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("minikube运行简单实例"),n("OutboundLink")],1)]),s._v(" "),n("li",[n("a",{attrs:{href:"https://kubernetes.io/zh/docs/tutorials/stateless-application/expose-external-ip-address/",target:"_blank",rel:"noopener noreferrer"}},[s._v("公开服务IP 地址以访问集群中应用程序"),n("OutboundLink")],1)]),s._v(" "),n("li",[n("a",{attrs:{href:"https://blog.csdn.net/boling_cavalry/article/details/90547822",target:"_blank",rel:"noopener noreferrer"}},[s._v("使用docker for window图形化快速搭建k8s"),n("OutboundLink")],1)]),s._v(" "),n("li",[n("a",{attrs:{href:"https://www.cnblogs.com/shanyou/p/8503839.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("win10环境安装minikube"),n("OutboundLink")],1)]),s._v(" "),n("li")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://jsd.cdn.zzko.cn/gh/hwj0123/BlogPictureRepository/blog/20210130150207759.png",alt:""}})]),s._v(" "),n("h3",{attrs:{id:"_2-2-搭建多节点的k8s集群"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-搭建多节点的k8s集群"}},[s._v("#")]),s._v(" 2.2 搭建多节点的k8s集群")]),s._v(" "),n("p",[s._v("参考："),n("a",{attrs:{href:"https://www.cnblogs.com/xkops/p/6169034.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("多节点k8s集群搭建"),n("OutboundLink")],1)]),s._v(" "),n("h2",{attrs:{id:"三、使用ansible自动化搭建k8s集群"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#三、使用ansible自动化搭建k8s集群"}},[s._v("#")]),s._v(" 三、使用ansible自动化搭建k8s集群")]),s._v(" "),n("p",[s._v("Ansible是一种IT自动化工具。它可以配置系统，部署软件以及协调更高级的IT任务，例如持续部署，滚动更新。Ansible适用于管理企业IT基础设施，从具有少数主机的小规模到数千个实例的企业环境。Ansible也是一种简单的自动化语言，可以完美地描述IT应用程序基础结构。")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://jsd.cdn.zzko.cn/gh/hwj0123/BlogPictureRepository/blog/b1009336b1bc57993aeca19d06a84e71.png",alt:""}})]),s._v(" "),n("ul",[n("li",[s._v("Inventory：Ansible管理的主机信息，包括IP地址、SSH端口、账号、密码等")]),s._v(" "),n("li",[s._v("Modules：任务均有模块完成，也可以自定义模块，例如经常用的脚本。")]),s._v(" "),n("li",[s._v("Plugins：使用插件增加Ansible核心功能，自身提供了很多插件，也可以自定义插件。例如connection插件，用于连接目标主机。")]),s._v(" "),n("li",[s._v("Playbooks：“剧本”，模块化定义一系列任务，供外部统一调用。Ansible核心功能。")])]),s._v(" "),n("p",[n("strong",[s._v("如何使用?")])]),s._v(" "),n("ol",[n("li",[s._v("将ansible-install-k8s-master.zip和binary_pkg.tar.gz上传到ansibleController主机的/root目录下并且解压。"),n("a",{attrs:{href:"https://pan.baidu.com/s/1WHORX2_ua1QVLX2ukp2FXA",target:"_blank",rel:"noopener noreferrer"}},[s._v("百度云链接"),n("OutboundLink")],1),s._v("，提取码：eq6x")]),s._v(" "),n("li",[s._v("进入ansible-install-k8s-master目录，找到其中的hosts文件")])]),s._v(" "),n("p",[n("img",{attrs:{src:"https://jsd.cdn.zzko.cn/gh/hwj0123/BlogPictureRepository/blog/20210130151412966.png",alt:""}})]),s._v(" "),n("p",[s._v("此文件是对应着自己规划的k8s集群节点的配置\n举例，一个有三个节点的k8s集群，其中\nk8s-master1--------192.168.139.142\nk8s-node1----------192.168.139.144\nk8s-node2----------192.168.139.145\n对应的hosts内容如下：")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("master"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果部署单Master，只保留一个Master节点")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".139.142 "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("node_name")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("k8s-master1\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#192.168.139.143 node_name=k8s-master2")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("node"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".139.144 "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("node_name")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("k8s-node1\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".139.145 "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("node_name")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("k8s-node2\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("etcd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".139.142 "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("etcd_name")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("etcd-1\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".139.144 "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("etcd_name")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("etcd-2\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".139.145 "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("etcd_name")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("etcd-3\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("lb"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果部署单Master，该项忽略")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#192.168.31.63 lb_name=lb-master")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#192.168.31.71 lb_name=lb-backup")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("k8s:children"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nmaster\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("node")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("newnode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#192.168.31.91 node_name=k8s-node3")]),s._v("\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br")])]),n("p",[s._v("3.修改group_vars/all.yml文件，软件包目录和证书可信任IP\n举例，一个有三个节点的k8s集群，其中\nk8s-master1--------192.168.139.142\nk8s-node1----------192.168.139.144\nk8s-node2----------192.168.139.145\n对应的group_vars/all.yml内容如下：")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@ansibleCenter ansible-install-k8s-master"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vi group_vars/all.yml ")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装目录")]),s._v("\nsoftware_dir: "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/root/binary_pkg'")]),s._v("\nk8s_work_dir: "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/opt/kubernetes'")]),s._v("\netcd_work_dir: "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/opt/etcd'")]),s._v("\ntmp_dir: "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/tmp/k8s'")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 集群网络")]),s._v("\nservice_cidr: "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'10.0.0.0/24'")]),s._v("\ncluster_dns: "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'10.0.0.2'")]),s._v("   "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 与roles/addons/files/coredns.yaml中IP一致")]),s._v("\npod_cidr: "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'10.244.0.0/16'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 与roles/addons/files/kube-flannel.yaml中网段一致")]),s._v("\nservice_nodeport_range: "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'30000-32767'")]),s._v("\ncluster_domain: "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'cluster.local'")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 高可用，如果部署单Master，该项忽略")]),s._v("\nvip: "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'192.168.31.88'")]),s._v("\nnic: "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'ens33'")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 自签证书可信任IP列表，为方便扩展，可添加多个预留IP")]),s._v("\ncert_hosts:\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 包含所有LB、VIP、Master IP和service_cidr的第一个IP")]),s._v("\n  k8s:\n    - "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.0")]),s._v(".0.1\n    - "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".139.142\n    - "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".139.144\n    - "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".139.145\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#    - 192.168.31.71")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#    - 192.168.31.72")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#    - 192.168.31.73")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#    - 192.168.31.88")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 包含所有etcd节点IP")]),s._v("\n  etcd:\n    - "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".139.142\n    - "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".139.144\n    - "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".139.145\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br")])]),n("p",[s._v("4.设置每个节点主机的root密码一致！\n通过"),n("code",[s._v("yum install ansible -y")]),s._v("安装ansible相关依赖，如果提示找不到ansible包，可通过配置yum源为阿里云来解决。\n使用命令"),n("code",[s._v("ansible-playbook -i hosts single-master-deploy.yml -uroot -k")]),s._v("即可，会提示输入root密码，输入正确密码后，等两三分钟即可。\n最后出现下图即为安装成功！")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://jsd.cdn.zzko.cn/gh/hwj0123/BlogPictureRepository/blog/2021013015301234.png",alt:""}})]),s._v(" "),n("h2",{attrs:{id:"四、从网上收集的一些与k8s-docker等有关的优秀博客列表"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#四、从网上收集的一些与k8s-docker等有关的优秀博客列表"}},[s._v("#")]),s._v(" 四、从网上收集的一些与k8s，docker等有关的优秀博客列表")]),s._v(" "),n("p",[s._v("参考：")]),s._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://www.cnblogs.com/linuxk/category/1248289.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.cnblogs.com/linuxk/category/1248289.html"),n("OutboundLink")],1)]),s._v(" "),n("li",[n("a",{attrs:{href:"https://www.cnblogs.com/you-men/category/1748786.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.cnblogs.com/you-men/category/1748786.html"),n("OutboundLink")],1)]),s._v(" "),n("li",[n("a",{attrs:{href:"https://www.cnblogs.com/wangxu01/tag/docker-kubernetes/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.cnblogs.com/wangxu01/tag/docker-kubernetes/"),n("OutboundLink")],1)]),s._v(" "),n("li",[n("a",{attrs:{href:"https://www.cnblogs.com/yuezhimi/category/1340864.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.cnblogs.com/yuezhimi/category/1340864.html"),n("OutboundLink")],1)]),s._v(" "),n("li",[n("a",{attrs:{href:"https://blog.csdn.net/wc1695040842/category_9959495.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://blog.csdn.net/wc1695040842/category_9959495.html"),n("OutboundLink")],1)])]),s._v(" "),n("hr")])}),[],!1,null,null,null);n.default=e.exports}}]);